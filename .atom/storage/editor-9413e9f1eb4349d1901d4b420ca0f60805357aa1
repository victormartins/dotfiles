{"version":1,"windowDimensions":{"x":-6,"y":23,"width":2560,"height":1417,"maximized":true},"grammars":{"grammarOverridesByPath":{}},"project":{"deserializer":"Project","paths":["/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca"],"buffers":[{"id":"0cd3a63621293f66e236fb706539b704","text":"NAME,COUNTRY,IS_FEDERAL,ANNOTATION_REPORT\nGST_HST,Canada,1,CRA_RETURN_ANNOTATION_REPORT\nPST_BC,Canada,0,BC_RETURN_ANNOTATION_REPORT\nPST_MB,Canada,0,MB_RETURN_ANNOTATION_REPORT\nQST,Canada,0,QC_RETURN_ANNOTATION_REPORT\nPST_SK,Canada,0,SK_RETURN_ANNOTATION_REPORT\n","defaultMarkerLayerId":"0","markerLayers":{"0":{"id":"0","maintainHistory":false,"markersById":{},"version":2},"1":{"id":"1","maintainHistory":false,"markersById":{},"version":2},"2":{"id":"2","maintainHistory":true,"markersById":{"1":{"range":{"start":{"row":6,"column":0},"end":{"row":6,"column":0}},"properties":{"type":"selection","goalScreenRange":null,"preserveFolds":true},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}},"version":2},"6":{"id":"6","maintainHistory":false,"markersById":{},"version":2},"10":{"id":"10","maintainHistory":false,"markersById":{},"version":2},"18":{"id":"18","maintainHistory":false,"markersById":{},"version":2},"22":{"id":"22","maintainHistory":false,"markersById":{},"version":2}},"nextMarkerLayerId":23,"history":{"version":3,"nextCheckpointId":8,"undoStack":[{"type":"checkpoint","id":1,"snapshot":{"2":{"1":{"range":[[1,9],[1,9]],"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}}},"isBoundary":false}],"redoStack":[{"type":"group-end","snapshot":{"2":{"1":{"range":[[3,0],[3,0]],"properties":{"type":"selection","goalScreenRange":null,"preserveFolds":true},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}}}},{"type":"change","content":{"oldRange":[[3,0],[3,0]],"newRange":[[3,0],[3,0]],"oldText":"","newText":""}},{"type":"change","content":{"oldRange":[[2,37],[2,37]],"newRange":[[2,37],[3,0]],"oldText":"","newText":"\n"}},{"type":"group-start","snapshot":{"2":{"1":{"range":[[2,37],[2,37]],"properties":{"type":"selection","goalScreenRange":null,"preserveFolds":true},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}}}}]},"encoding":"utf8","filePath":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_types.csv","digestWhenLastPersisted":"044692e318274867980a0c45eea84685a8219b79","preferredLineEnding":null,"nextMarkerId":8,"deserializer":"TextBuffer","version":5},{"id":"24f8d98b91e55ad73bd50d1d686c5188","text":"module SageOneGacCa\n  module Handlers\n    # Contacts\n    module Contacts\n      # Implement CA specific validation\n      class VatNumberValidator < ::GlobalAccountingBase::Handlers::Contacts::VatNumberValidator\n        # list of countries which have VAT Number\n        COUNTRIES_WITH_VAT_NUMBER = ['AT', 'BE', 'BG', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HR', 'HU', 'IE',\n                                     'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE', 'GB']\n\n        # validate CA specific tax_number\n        def tax_number(record, options)\n          return if record.tax_number.blank?\n          for_country = options[:for_country]\n          contact_country = for_country.call(record)\n          contact_country_code = contact_country.code\n          # # if the contact is from a country which has VAT number, the existing validation rule should be applied\n          if COUNTRIES_WITH_VAT_NUMBER.include?(contact_country_code)\n            super\n          end\n        end\n      end\n    end\n  end\nend\n","defaultMarkerLayerId":"0","markerLayers":{"0":{"id":"0","maintainHistory":false,"markersById":{"2":{"range":{"start":{"row":7,"column":36},"end":{"row":7,"column":120}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"inside"},"3":{"range":{"start":{"row":7,"column":36},"end":{"row":7,"column":120}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"inside"},"4":{"range":{"start":{"row":17,"column":10},"end":{"row":17,"column":12}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"inside"},"5":{"range":{"start":{"row":17,"column":10},"end":{"row":17,"column":12}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"inside"}},"version":2},"1":{"id":"1","maintainHistory":false,"markersById":{},"version":2},"2":{"id":"2","maintainHistory":true,"markersById":{"1":{"range":{"start":{"row":16,"column":27},"end":{"row":16,"column":27}},"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}},"version":2},"4":{"id":"4","maintainHistory":false,"markersById":{},"version":2}},"nextMarkerLayerId":5,"history":{"version":3,"nextCheckpointId":2,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/lib/sage_one_gac_ca/handlers/contacts/vat_number_validator.rb","digestWhenLastPersisted":"1152795eca5fac8d5247c41d7c57eb42a6ebf7c1","preferredLineEnding":null,"nextMarkerId":6,"deserializer":"TextBuffer","version":5},{"id":"bcacd8c3fb0d33840f29da1694d72441","text":"NAME,COUNTRY,EC_SALES_DESCRIPTION_NAME,TAXABLE,TYPE,IS_SYSTEM\nGST_PST_SK,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nGST_PST_BC,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nGST_PST_MB,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nGST_QST,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nHST_NB_NL_ON,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nHST_PE,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nHST_NS,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nGST,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nHST_NB_NL_NS_ON_PE,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nPST_SK,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nPST_BC,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nPST_MB,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nQST,Canada,standard,1,CoreAccounting::Taxes::Models::TaxRate,1\nCANADIAN_ZERO,Canada,zero,1,CoreAccounting::Taxes::Models::ZeroTaxRate,1\nCANADIAN_EXEMPT,Canada,exempt,1,CoreAccounting::Taxes::Models::ExemptTaxRate,1\nCANADIAN_NO_TAX,Canada,outside_scope_of_vat,0,CoreAccounting::Taxes::Models::NoTaxRate,1\n","defaultMarkerLayerId":"0","markerLayers":{"0":{"id":"0","maintainHistory":false,"markersById":{},"version":2},"1":{"id":"1","maintainHistory":false,"markersById":{},"version":2},"2":{"id":"2","maintainHistory":true,"markersById":{"1":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}},"version":2},"6":{"id":"6","maintainHistory":false,"markersById":{},"version":2}},"nextMarkerLayerId":7,"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_rates.csv","digestWhenLastPersisted":"a118fac5303e93f17a5ea7f25ddcd034a39a6071","preferredLineEnding":null,"nextMarkerId":2,"deserializer":"TextBuffer","version":5}]},"workspace":{"deserializer":"Workspace","paneContainer":{"deserializer":"PaneContainer","version":1,"root":{"deserializer":"Pane","id":3,"items":[{"deserializer":"TextEditor","id":36,"softTabs":true,"firstVisibleScreenRow":0,"firstVisibleScreenColumn":0,"displayBuffer":{"deserializer":"DisplayBuffer","id":37,"softWrapped":false,"tokenizedBuffer":{"deserializer":"TokenizedBuffer","bufferPath":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_types.csv","bufferId":"0cd3a63621293f66e236fb706539b704","largeFileMode":false},"largeFileMode":false,"foldsMarkerLayerId":"1"},"selectionsMarkerLayerId":"2"},{"deserializer":"TextEditor","id":44,"softTabs":true,"firstVisibleScreenRow":0,"firstVisibleScreenColumn":0,"displayBuffer":{"deserializer":"DisplayBuffer","id":45,"softWrapped":false,"tokenizedBuffer":{"deserializer":"TokenizedBuffer","bufferPath":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/lib/sage_one_gac_ca/handlers/contacts/vat_number_validator.rb","bufferId":"24f8d98b91e55ad73bd50d1d686c5188","largeFileMode":false},"largeFileMode":false,"foldsMarkerLayerId":"1"},"selectionsMarkerLayerId":"2"},{"deserializer":"TextEditor","id":48,"softTabs":true,"firstVisibleScreenRow":0,"firstVisibleScreenColumn":0,"displayBuffer":{"deserializer":"DisplayBuffer","id":49,"softWrapped":false,"tokenizedBuffer":{"deserializer":"TokenizedBuffer","bufferPath":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_rates.csv","bufferId":"bcacd8c3fb0d33840f29da1694d72441","largeFileMode":false},"largeFileMode":false,"foldsMarkerLayerId":"1"},"selectionsMarkerLayerId":"2"}],"activeItemURI":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_rates.csv","focused":true,"flexScale":1},"activePaneId":3},"packagesWithActiveGrammars":["language-ruby-on-rails","language-ruby","language-hyperlink","language-todo"],"destroyedItemURIs":["/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/annotation_element_tax_rate_associations.csv","/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/lib/tasks/data_fixes.rake","/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/lib/tasks/seeds.rake","/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_submission_frequency_types.csv","/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_types_tax_sub_freq_types.csv"]},"packageStates":{"fuzzy-finder":{"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_types.csv":1460985415929,"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/lib/sage_one_gac_ca/handlers/contacts/vat_number_validator.rb":1460985742632,"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_rates.csv":1461069170400},"keybinding-resolver":{},"metrics":{"sessionLength":84896552},"tree-view":{"directoryExpansionStates":{"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca":{"isExpanded":true,"entries":{".git":{"isExpanded":false,"entries":{}},".idea":{"isExpanded":false,"entries":{}},".yardoc":{"isExpanded":false,"entries":{}},"config":{"isExpanded":true,"entries":{}},"coverage":{"isExpanded":false,"entries":{}},"db":{"isExpanded":false,"entries":{}},"lib":{"isExpanded":false,"entries":{}},"log":{"isExpanded":false,"entries":{}},"script":{"isExpanded":false,"entries":{}},"seeds":{"isExpanded":true,"entries":{"data":{"isExpanded":true,"entries":{}}}},"soroban":{"isExpanded":false,"entries":{}},"spec":{"isExpanded":false,"entries":{}}}}},"selectedPath":"/Users/victor.martins/Documents/SAGE/code/UK/sage_one_gac_ca/seeds/data/tax_rates.csv","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":511},"linter":{"scope":"File"}},"fullScreen":false}